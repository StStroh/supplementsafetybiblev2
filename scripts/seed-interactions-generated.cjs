const { createClient } = require('@supabase/supabase-js');
require('dotenv').config();

const supabase = createClient(
  process.env.VITE_SUPABASE_URL,
  process.env.SUPABASE_SERVICE_ROLE_KEY
);

// Generated from interactions_raw data
const interactions = [
  { interaction_id: 'INT_001', a_substance_id: 'D_FLUOXETINE', b_substance_id: 'S_ST_JOHNS_WORT', interaction_type: 'pharmacodynamic', severity: 'avoid', summary_short: 'Severe risk of serotonin syndrome', mechanism: 'St. John\'s Wort inhibits serotonin reuptake and may have MAO inhibitory effects combined with SSRI increases serotonin toxicity risk.', clinical_effect: 'Serotonin syndrome symptoms: confusion agitation muscle twitching sweating tremor fever.', management: 'Avoid combination. Discontinue St. John\'s Wort at least 2 weeks before starting SSRI.', evidence_grade: 'A', confidence: 'high', citations: [] },
  { interaction_id: 'INT_002', a_substance_id: 'D_WARFARIN', b_substance_id: 'S_GINKGO', interaction_type: 'pharmacodynamic', severity: 'caution', summary_short: 'Increased bleeding risk when combining warfarin with ginkgo', mechanism: 'Ginkgo has antiplatelet effects and may inhibit platelet-activating factor potentially enhancing warfarin\'s anticoagulant effects.', clinical_effect: 'Increased risk of bleeding bruising or hemorrhage. May affect INR stability.', management: 'Monitor INR more frequently. Watch for signs of bleeding. Consider avoiding or using with close monitoring.', evidence_grade: 'B', confidence: 'moderate', citations: [] },
  { interaction_id: 'INT_003', a_substance_id: 'D_WARFARIN', b_substance_id: 'S_GARLIC', interaction_type: 'pharmacodynamic', severity: 'caution', summary_short: 'Garlic may enhance anticoagulant effects', mechanism: 'Garlic has antiplatelet properties and may affect platelet aggregation potentially increasing bleeding risk.', clinical_effect: 'Increased bleeding tendency prolonged bleeding time bruising.', management: 'Monitor INR closely if taking high-dose garlic supplements. Use garlic in food amounts generally considered safe.', evidence_grade: 'B', confidence: 'moderate', citations: [] },
  { interaction_id: 'INT_004', a_substance_id: 'D_WARFARIN', b_substance_id: 'S_FISH_OIL', interaction_type: 'pharmacodynamic', severity: 'caution', summary_short: 'Fish oil may increase bleeding risk', mechanism: 'Omega-3 fatty acids have mild antiplatelet effects that may enhance anticoagulation.', clinical_effect: 'Potential for increased bleeding particularly at high doses (>3g/day).', management: 'Use fish oil doses under 3g/day. Monitor for bleeding signs. Check INR more frequently.', evidence_grade: 'B', confidence: 'moderate', citations: [] },
  { interaction_id: 'INT_005', a_substance_id: 'D_WARFARIN', b_substance_id: 'S_VITAMIN_E', interaction_type: 'pharmacodynamic', severity: 'caution', summary_short: 'Vitamin E may enhance anticoagulant effects', mechanism: 'Vitamin E at high doses (>400 IU) may inhibit platelet aggregation and enhance anticoagulation.', clinical_effect: 'Increased bleeding risk especially at doses above 400 IU daily.', management: 'Limit vitamin E to <400 IU daily. Monitor INR if taking higher doses.', evidence_grade: 'B', confidence: 'moderate', citations: [] },
  { interaction_id: 'INT_006', a_substance_id: 'D_ALPRAZOLAM', b_substance_id: 'S_MELATONIN', interaction_type: 'pharmacodynamic', severity: 'caution', summary_short: 'Additive sedative effects', mechanism: 'Both substances cause CNS depression and sedation through different mechanisms.', clinical_effect: 'Excessive drowsiness dizziness impaired coordination risk of falls.', management: 'Use together only under medical supervision. Avoid activities requiring alertness. Consider timing doses separately.', evidence_grade: 'C', confidence: 'moderate', citations: [] },
  { interaction_id: 'INT_007', a_substance_id: 'D_WARFARIN', b_substance_id: 'S_VITAMIN_K', interaction_type: 'pharmacodynamic', severity: 'monitor', summary_short: 'Vitamin K antagonizes warfarin effects', mechanism: 'Vitamin K is required for clotting factor synthesis. High vitamin K intake reduces warfarin effectiveness.', clinical_effect: 'Decreased INR reduced anticoagulation increased clotting risk.', management: 'Maintain consistent vitamin K intake. Avoid sudden increases in vitamin K-rich foods or supplements.', evidence_grade: 'A', confidence: 'high', citations: [] },
  { interaction_id: 'INT_008', a_substance_id: 'D_LEVOTHYROXINE', b_substance_id: 'S_IRON', interaction_type: 'pharmacodynamic', severity: 'monitor', summary_short: 'Iron reduces levothyroxine absorption', mechanism: 'Iron chelates with levothyroxine in the GI tract forming insoluble complexes.', clinical_effect: 'Reduced thyroid hormone levels potential hypothyroid symptoms.', management: 'Separate doses by at least 4 hours. Monitor TSH levels.', evidence_grade: 'A', confidence: 'high', citations: [] },
  { interaction_id: 'INT_009', a_substance_id: 'D_LEVOTHYROXINE', b_substance_id: 'S_CALCIUM', interaction_type: 'pharmacodynamic', severity: 'monitor', summary_short: 'Calcium reduces levothyroxine absorption', mechanism: 'Calcium binds to levothyroxine in the GI tract reducing bioavailability.', clinical_effect: 'Decreased thyroid hormone levels possible need for dose adjustment.', management: 'Take levothyroxine at least 4 hours apart from calcium. Monitor TSH.', evidence_grade: 'A', confidence: 'high', citations: [] },
  { interaction_id: 'INT_010', a_substance_id: 'S_GINKGO', b_substance_id: 'S_VITAMIN_E', interaction_type: 'pharmacodynamic', severity: 'caution', summary_short: 'Increased bleeding risk when combined', mechanism: 'Both have antiplatelet effects that may be additive.', clinical_effect: 'Enhanced bleeding tendency particularly with high doses of vitamin E (>400 IU).', management: 'Use together with caution. Monitor for unusual bleeding or bruising. Keep vitamin E below 400 IU daily.', evidence_grade: 'B', confidence: 'moderate', citations: [] },
  { interaction_id: 'INT_011', a_substance_id: 'S_FISH_OIL', b_substance_id: 'S_GINKGO', interaction_type: 'pharmacodynamic', severity: 'caution', summary_short: 'Additive antiplatelet effects increase bleeding risk', mechanism: 'Both omega-3 fatty acids and ginkgo have antiplatelet properties.', clinical_effect: 'Increased risk of bleeding bruising especially at high doses.', management: 'Use together with caution. Monitor for bleeding signs. Keep fish oil below 3g/day.', evidence_grade: 'B', confidence: 'moderate', citations: [] },
  { interaction_id: 'INT_012', a_substance_id: 'S_FISH_OIL', b_substance_id: 'S_VITAMIN_E', interaction_type: 'pharmacodynamic', severity: 'monitor', summary_short: 'Both have antiplatelet effects', mechanism: 'Mild additive antiplatelet activity.', clinical_effect: 'Slightly increased bleeding risk at high doses of both.', management: 'Generally safe at moderate doses. Monitor for unusual bleeding if taking high doses of both.', evidence_grade: 'C', confidence: 'low', citations: [] },
  { interaction_id: 'INT_013', a_substance_id: 'S_CALCIUM', b_substance_id: 'S_IRON', interaction_type: 'pharmacodynamic', severity: 'monitor', summary_short: 'Calcium reduces iron absorption', mechanism: 'Both compete for the same intestinal absorption pathways.', clinical_effect: 'Reduced iron absorption potential for iron deficiency with chronic co-administration.', management: 'Separate doses by 2-4 hours for optimal absorption of both.', evidence_grade: 'A', confidence: 'high', citations: [] },
  { interaction_id: 'INT_014', a_substance_id: 'S_CALCIUM', b_substance_id: 'S_VITAMIN_D', interaction_type: 'pharmacodynamic', severity: 'info', summary_short: 'Vitamin D enhances calcium absorption', mechanism: 'Vitamin D is required for optimal calcium absorption in the intestine.', clinical_effect: 'Beneficial combination for bone health. Vitamin D improves calcium utilization.', management: 'Recommended to take together for bone health. Common and safe combination.', evidence_grade: 'A', confidence: 'high', citations: [] },
  { interaction_id: 'INT_015', a_substance_id: 'S_IRON', b_substance_id: 'S_VITAMIN_C', interaction_type: 'pharmacodynamic', severity: 'info', summary_short: 'Vitamin C enhances iron absorption', mechanism: 'Vitamin C reduces ferric iron to ferrous form which is more readily absorbed.', clinical_effect: 'Beneficial interaction. Vitamin C significantly improves non-heme iron absorption.', management: 'Recommended to take together especially for plant-based iron sources.', evidence_grade: 'A', confidence: 'high', citations: [] },
  { interaction_id: 'INT_016', a_substance_id: 'S_MAGNESIUM', b_substance_id: 'S_VITAMIN_D', interaction_type: 'pharmacodynamic', severity: 'info', summary_short: 'Magnesium needed for vitamin D metabolism', mechanism: 'Magnesium is a cofactor for enzymes that activate vitamin D.', clinical_effect: 'Beneficial combination. Magnesium deficiency may impair vitamin D utilization.', management: 'Recommended to take together. Both support bone health and metabolic function.', evidence_grade: 'B', confidence: 'moderate', citations: [] },
  { interaction_id: 'INT_017', a_substance_id: 'S_CALCIUM', b_substance_id: 'S_MAGNESIUM', interaction_type: 'pharmacodynamic', severity: 'monitor', summary_short: 'High calcium may reduce magnesium absorption', mechanism: 'Both compete for absorption in the intestine.', clinical_effect: 'Very high calcium intake may impair magnesium absorption over time.', management: 'Use balanced ratio (2:1 calcium to magnesium). Separate doses by 2 hours if taking high doses.', evidence_grade: 'B', confidence: 'moderate', citations: [] }
];

async function seed() {
  console.log('Inserting', interactions.length, 'interactions...');

  // Insert in batches of 10
  for (let i = 0; i < interactions.length; i += 10) {
    const batch = interactions.slice(i, i + 10);
    const { error } = await supabase.from('checker_interactions').upsert(batch, { onConflict: 'interaction_id' });
    if (error) {
      console.error('Error inserting interactions batch', i, ':', error.message);
    } else {
      console.log('Inserted interactions', i, '-', Math.min(i + 10, interactions.length));
    }
  }

  // Count interactions
  const { count: intCount } = await supabase.from('checker_interactions').select('*', { count: 'exact', head: true });
  console.log('âœ… Total interactions:', intCount);
}

seed().catch(console.error);
